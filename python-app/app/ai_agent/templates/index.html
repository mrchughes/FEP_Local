<!DOCTYPE html>
<html>
<head>
    <title>Chris' Chatbot</title>
    <style>
        body {
            background-image: url(/static/images/background.jpg);
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family: Arial, sans-serif;
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
        }

        .chat-container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            width: 95%;
            max-width: 750px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        #chat-box {
            white-space: pre-line;
            border: 1px solid #ccc;
            padding: 10px;
            height: 400px;
            overflow-y: scroll;
            background-color: #f0f0f0;
            color: darkblue;
            margin-bottom: 10px;
        }

        #input, button {
            padding: 10px;
            font-size: 1em;
        }

        input[type="text"] {
            width: 70%;
        }
    </style>
</head>
<body>

    <h1 class="title">Chris' Chatbot</h1>

    <style>
    .title {
        font-size: 3rem;
        font-weight: 700;
        color: white; /* bright text */
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.8); /* dark shadow for contrast */
        background-color: rgba(0, 0, 0, 0.4); /* semi-transparent black bg */
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        display: inline-block; /* shrink to fit content */
    }
    </style>
    

    <div class="chat-container">
        <form id="upload-form" enctype="multipart/form-data" style="margin-bottom: 20px;">
            <label for="file-upload">Upload DWP Policy Document (PDF, DOCX, TXT): </label>
            <input id="file-upload" type="file" name="file" accept=".pdf,.docx,.txt" required>
            <button type="submit">Upload</button>
            <span id="upload-status"></span>
        </form>
        <div id="chat-box"></div>
        <input id="input" type="text" placeholder="Ask something..." autofocus>
    </div>

    <script>
        window.onload = function () {
            // Chat logic
            function sendMessage() {
                const inputField = document.getElementById("input");
                const input = inputField.value.trim();
                if (!input) return;
                inputField.disabled = true;
                fetch('/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ input: input })
                })
                .then(response => response.json())
                .then(data => {
                    const chatBox = document.getElementById("chat-box");
                    chatBox.innerText += "You: " + input + "\nAssistant: " + data.response + "\n\n";
                    inputField.value = "";
                    inputField.disabled = false;
                    chatBox.scrollTop = chatBox.scrollHeight;
                })
                .catch(error => console.error('Error:', error));
            }

            document.getElementById("input").addEventListener("keydown", function(event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                    sendMessage();
                }
            });

            // Upload logic
            document.getElementById("upload-form").addEventListener("submit", function(event) {
                event.preventDefault();
                const fileInput = document.getElementById("file-upload");
                const status = document.getElementById("upload-status");
                const formData = new FormData();
                formData.append("file", fileInput.files[0]);
                status.textContent = "Uploading...";
                fetch("/upload", {
                    method: "POST",
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    status.textContent = data.success ? "Upload successful!" : "Upload failed.";
                    fileInput.value = "";
                })
                .catch(() => {
                    status.textContent = "Upload failed.";
                });
            });
        };
    </script>
</body>
</html>
